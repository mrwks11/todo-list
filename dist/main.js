(()=>{const t=document.querySelector("[data-project-list]"),e=document.querySelector("[data-new-project-form"),a=document.querySelector("[data-new-project-title-input]"),n=document.querySelector("[data-task-list-container]"),o=document.querySelector("[data-project-title"),s=document.querySelector("[data-task-list]"),l=(document.querySelector("[data-task-count"),document.querySelector("[data-new-task-form]")),c=document.querySelector("[data-new-task-title-input]"),r=document.querySelector("[data-new-task-description-input]"),i=document.querySelector("[data-new-task-date-input]"),d=document.querySelector("[data-new-task-time-input]"),u=document.querySelector("[data-new-task-priority-input]"),m="projects",p="selectedProjectId";let k=JSON.parse(localStorage.getItem(m))||[],v=localStorage.getItem(p);function f(){g(t),k.forEach((e=>{const a=document.createElement("li");a.dataset.projectId=e.id,a.classList.add("project-list-item"),a.innerText=e.title,e.id==v&&a.classList.add("active-project");const n=document.createElement("button");n.setAttribute("data-project-remove-button",""),n.classList.add("button","project-remove-button"),n.innerText="X",a.appendChild(n),t.appendChild(a)}));const e=k.find((t=>t.id==v));console.log(e),null==e||null==e?n.innerHTML="<h2>No project selected.</h2>":o.innerText=e.title,g(s),function(t){t.tasks.forEach((t=>{const e=document.createElement("li");e.dataset.taskId=t.id,e.classList.add("task-list-item"),e.innerText=t.title,t.complete&&e.classList.add("task-complete");const a=document.createElement("button");a.setAttribute("data-task-details-button",""),a.classList.add("button","task-details-button"),a.innerText="Details";const n=document.createElement("button");n.setAttribute("data-task-remove-button",""),n.classList.add("button","task-remove-button"),n.innerText="X",e.appendChild(n),e.appendChild(a),s.appendChild(e)}))}(e)}function g(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function S(){a.value=null,c.value=null,r.value=null,r.value=null,i.value=null,u.value=null}function E(){localStorage.setItem(m,JSON.stringify(k)),localStorage.setItem(p,v)}e.addEventListener("submit",(t=>{t.preventDefault();const e=a.value;if(null===e||""===e)return;const n=function(t){return{title:t,id:(new Date).valueOf(),tasks:[]}}(e);S(),k.push(n),E(),f()})),t.addEventListener("click",(t=>{t.target.classList.contains("project-list-item")&&(v=t.target.dataset.projectId,console.log(v),E(),f())})),t.addEventListener("click",(t=>{var e;t.target.classList.contains("project-remove-button")&&(k.filter((t=>{t.id!==v&&(v=null)})),t.target.parentElement.remove(),e=t.target,k.forEach(((t,a)=>{t.id==e.parentElement.dataset.projectId&&k.splice(a,1)})),localStorage.setItem(m,JSON.stringify(k)),E(),f())})),l.addEventListener("submit",(t=>{t.preventDefault();const e=c.value,a=r.value,n=i.value,o=d.value,s=u.value;if(null===e||""===e)return;const l=function(t,e,a,n,o){return{title:t,id:(new Date).valueOf(),description:e,date:a,time:n,priority:o,complete:!1}}(e,a,n,o,s);S(),k.find((t=>t.id==v)).tasks.push(l),E(),f()})),s.addEventListener("click",(t=>{const e=k.find((t=>t.id==v));e.tasks.forEach(((a,n)=>{a.id==t.target.dataset.taskId&&(!1===e.tasks[n].complete?(t.target.classList.add("task-complete"),e.tasks[n].complete=!0):(t.target.classList.remove("task-complete"),e.tasks[n].complete=!1))})),console.log(e.tasks),E()})),s.addEventListener("click",(t=>{t.target.classList.contains("task-remove-button")&&(t.target.parentElement.remove(),function(t){const e=k.find((t=>t.id==v));e.tasks.forEach(((a,n)=>{a.id==t.parentElement.dataset.taskId&&e.tasks.splice(n,1)})),localStorage.setItem(m,JSON.stringify(k))}(t.target),E(),f())})),document.addEventListener("DOMContentLoaded",f),console.log(k)})();