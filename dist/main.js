(()=>{const t=document.querySelector("[data-project-list]"),e=document.querySelector("[data-new-project-form"),a=document.querySelector("[data-new-project-title-input]"),n=(document.querySelector("[data-task-list-container]"),document.querySelector("[data-project-title")),s=document.querySelector("[data-task-list]"),i=document.querySelector("[data-task-count"),d=document.querySelector("[data-new-task-form]"),o=document.querySelector("[data-new-task-title-input]"),c=document.querySelector("[data-new-task-description-input]"),l=document.querySelector("[data-new-task-date-input]"),r=document.querySelector("[data-new-task-time-input]"),u=document.querySelector("[data-new-task-priority-input]"),m=document.querySelector("[data-clear-completed-tasks]"),k=document.querySelector("[data-task-modal]"),p=(document.querySelector("[data-task-modal-content]"),document.querySelector("[data-edit-task-legend]")),v=document.querySelector("[data-edit-task-form]"),f=document.querySelector("[data-edit-task-title-input]"),y=document.querySelector("[data-edit-task-description-input]"),S=document.querySelector("[data-edit-task-date-input]"),g=document.querySelector("[data-edit-task-time-input]"),E=document.querySelector("[data-edit-task-priority-input]"),L="projects",b="selectedProjectId";let q=JSON.parse(localStorage.getItem(L))||[],h=localStorage.getItem(b);function j(){I(t),q.forEach((e=>{const a=document.createElement("div");a.dataset.projectId=e.id,a.classList.add("project-list-item"),a.innerText="- "+e.title,e.id==h&&a.classList.add("active-project");const n=document.createElement("button");n.setAttribute("data-project-remove-button",""),n.classList.add("button","project-remove-button"),n.innerText="X",a.appendChild(n),t.appendChild(a)}));const e=q.find((t=>t.id==h));n.innerText=null==e||null==e?"No project selected.":""+e.title,I(s),function(t){t.tasks.forEach((t=>{const e=document.createElement("div");e.dataset.taskId=t.id,e.classList.add("task-list-item"),e.innerText="- "+t.title,t.complete&&e.classList.add("task-complete");const a=document.createElement("button");a.setAttribute("data-task-details-button",""),a.classList.add("button","task-details-button"),a.innerText="Details";const n=document.createElement("button");n.setAttribute("data-task-remove-button",""),n.classList.add("button","task-remove-button"),n.innerText="X",e.appendChild(n),e.appendChild(a),s.appendChild(e)}))}(e),function(t){const e=t.tasks.filter((t=>!t.complete)).length,a=1==e?"Task":"Tasks";i.innerText=`${e} ${a} Remaining`}(e)}function I(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function T(){a.value=null,o.value=null,c.value=null,c.value=null,l.value=null}function w(){localStorage.setItem(L,JSON.stringify(q)),localStorage.setItem(b,h)}e.addEventListener("submit",(t=>{t.preventDefault();const e=a.value;if(null===e||""===e)return;const n=function(t){return{title:t,id:(new Date).valueOf(),tasks:[]}}(e);T(),q.push(n),w(),j()})),t.addEventListener("click",(t=>{t.target.classList.contains("project-list-item")&&(h=t.target.dataset.projectId,w(),j())})),t.addEventListener("click",(t=>{var e;t.target.classList.contains("project-remove-button")&&(q.filter((t=>{t.id!==h&&(h=null)})),t.target.parentElement.remove(),e=t.target,q.forEach(((t,a)=>{t.id==e.parentElement.dataset.projectId&&q.splice(a,1)})),localStorage.setItem(L,JSON.stringify(q)),w(),j())})),d.addEventListener("submit",(t=>{t.preventDefault();const e=o.value,a=c.value,n=l.value,s=r.value,i=u.value;if(null===e||""===e)return;const d=function(t,e,a,n,s){return{title:t,id:(new Date).valueOf(),description:e,date:a,time:n,priority:s,complete:!1}}(e,a,n,s,i);T(),q.find((t=>t.id==h)).tasks.push(d),w(),j()})),s.addEventListener("click",(t=>{const e=q.find((t=>t.id==h));e.tasks.forEach(((a,n)=>{a.id==t.target.dataset.taskId&&(!1===e.tasks[n].complete?(t.target.classList.add("task-complete"),e.tasks[n].complete=!0):(t.target.classList.remove("task-complete"),e.tasks[n].complete=!1))})),w(),j()})),s.addEventListener("click",(t=>{t.target.classList.contains("task-remove-button")&&(t.target.parentElement.remove(),function(t){const e=q.find((t=>t.id==h));e.tasks.forEach(((a,n)=>{a.id==t.parentElement.dataset.taskId&&e.tasks.splice(n,1)})),localStorage.setItem(L,JSON.stringify(q))}(t.target),w(),j())})),m.addEventListener("click",(t=>{const e=q.find((t=>t.id==h));e.tasks=e.tasks.filter((t=>!t.complete)),w(),j()})),s.addEventListener("click",(t=>{const e=q.find((t=>t.id==h));t.target.classList.contains("task-details-button")&&(k.style.display="block",e.tasks.forEach(((a,n)=>{a.id==t.target.parentElement.dataset.taskId&&(p.innerText=`Edit Task (ID: ${a.id})`,p.setAttribute("data-task-id",""+a.id),f.value=e.tasks[n].title,y.value=e.tasks[n].description,S.value=e.tasks[n].date,g.value=e.tasks[n].time,E.value=e.tasks[n].priority)})))})),v.addEventListener("submit",(t=>{t.preventDefault();const e=f.value,a=y.value,n=S.value,s=g.value,i=E.value;if(null===e||""===e)return;const d=q.find((t=>t.id==h));d.tasks.forEach(((t,o)=>{t.id==p.dataset.taskId&&(d.tasks[o].title=e,d.tasks[o].description=a,d.tasks[o].date=n,d.tasks[o].time=s,d.tasks[o].priority=i)})),k.style.display="none",w(),j()})),v.addEventListener("click",(t=>{t.target.classList.contains("task-cancel-button")&&(k.style.display="none")})),document.addEventListener("click",(t=>{(t.target.classList.contains("task-modal")||t.target.classList.contains("task-modal-content"))&&(k.style.display="none")})),document.addEventListener("DOMContentLoaded",j)})();